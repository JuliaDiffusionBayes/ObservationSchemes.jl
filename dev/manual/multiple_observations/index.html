<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Multiple observations · ObservationSchemes.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">ObservationSchemes.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../get_started/overview/">Get started</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">User manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../observation_schemes/">A single observation</a></li><li><a class="tocitem" href="../start_pt_prior/">Priors over starting points</a></li><li class="is-active"><a class="tocitem" href>Multiple observations</a><ul class="internal"><li><a class="tocitem" href="#Defining-a-single-recording-1"><span>Defining a single recording</span></a></li><li><a class="tocitem" href="#Defining-multiple-recordings-1"><span>Defining multiple recordings</span></a></li></ul></li><li><a class="tocitem" href="../parameterized_obs/">Parameterized observations</a></li><li><a class="tocitem" href="../utility_functions/">Utility fuctions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">How to...</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../how_to_guides/simple_os/">(TODO) Efficiently deal with simple observation schemes</a></li><li><a class="tocitem" href="../../how_to_guides/custom_priors/">(TODO) Define custom priors over starting points</a></li><li><a class="tocitem" href="../../how_to_guides/custom_os/">(TODO) Define custom observation schemes</a></li><li><a class="tocitem" href="../../how_to_guides/dataframes/">(TODO) Work with dataframes</a></li><li><a class="tocitem" href="../../how_to_guides/csv_files/">(TODO) Work with CSV files</a></li><li><a class="tocitem" href="../../how_to_guides/other_processes/">(TODO) Deal with other stochastic processes</a></li><li><a class="tocitem" href="../../how_to_guides/update_params/">(TODO) Update parameters for AllObservations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/single_path/">(TODO) Single path</a></li><li><a class="tocitem" href="../../tutorials/multi_paths/">(TODO) Multiple paths</a></li><li><a class="tocitem" href="../../tutorials/multi_paths_diff_observ/">(TODO) Multiple paths differently observed</a></li><li><a class="tocitem" href="../../tutorials/mixed_effect_models/">(TODO) Mixed effect models</a></li><li><a class="tocitem" href="../../tutorials/hmm/">(TODO) Observations of HMM driven by ARCH(1)</a></li></ul></li><li><a class="tocitem" href="../../module_index/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User manual</a></li><li class="is-active"><a href>Multiple observations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Multiple observations</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/master/docs/src/manual/multiple_observations.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Multiple-observations-1"><a class="docs-heading-anchor" href="#Multiple-observations-1">Multiple observations</a><a class="docs-heading-anchor-permalink" href="#Multiple-observations-1" title="Permalink"></a></h1><p>Multiple discrete-time observations of a single trajectory are referred to in this package as a single <strong>recording</strong>. Below we describe how to handle observations of</p><ul><li>a single recording</li><li>multiple recordings from the same law</li><li>multiple recordings from multiple laws</li></ul><h2 id="Defining-a-single-recording-1"><a class="docs-heading-anchor" href="#Defining-a-single-recording-1">Defining a single recording</a><a class="docs-heading-anchor-permalink" href="#Defining-a-single-recording-1" title="Permalink"></a></h2><p>To fully describe a single recording we need four elements:</p><ul><li>A diffusion law that the underlying process is following</li><li>A starting time</li><li>A prior over the starting point</li><li>Discrete-time observations of the process</li></ul><p>Consequently, this package adopts the convention of defining a single recording with a <code>NamedTuple</code>:</p><pre><code class="language-julia">recording = (
    P = ...,
    obs = ...,
    t0 = ...,
    x0_prior = ...,
)</code></pre><p>The law <code>P</code> needs to be defined by the user and a package <a href="https://github.com/mmider/DiffusionDefinition.jl">DiffusionDefinition.jl</a> can be used to this end. <strong>There must exist an implementation of a function <code>param_name(::typeof(P))</code> if one wants to use functions and structs presented below</strong>. <code>obs</code> is assumed to be a vector of observations, with each element being of the type inheriting from <code>Observation{D,T}</code>. <code>x0_prior</code> is assumed to inherit from <code>StartingPtPrior{T}</code>.</p><h2 id="Defining-multiple-recordings-1"><a class="docs-heading-anchor" href="#Defining-multiple-recordings-1">Defining multiple recordings</a><a class="docs-heading-anchor-permalink" href="#Defining-multiple-recordings-1" title="Permalink"></a></h2><h3 id="Recordings-under-a-single,-shared-law-1"><a class="docs-heading-anchor" href="#Recordings-under-a-single,-shared-law-1">Recordings under a single, shared law</a><a class="docs-heading-anchor-permalink" href="#Recordings-under-a-single,-shared-law-1" title="Permalink"></a></h3><p>A struct <code>AllObservations</code> allows for a systematic definition of multiple recordings and, in addition, provides some handy functionality. For instance, we can define multiple recordings as follows:</p><pre><code class="language-julia">struct LawA α; β; end
DiffObservScheme.param_names(P::LawA) = [:α, :β]

recordings = [
    (
        P = LawA(10,20),
        obs = [
            LinearGsnObs(1.0, 1.0; Σ=1.0),
            LinearGsnObs(2.0, 2.0; full_obs=true),
            LinearGsnObs(3.0, 3.0; Σ=2.0),
        ],
        t0 = 0.0,
        x0_prior = KnownStartingPt(2.0),
    ),
    (
        P = LawA(10,20),
        obs = [
            LinearGsnObs(1.3, 1.0; full_obs=true),
            LinearGsnObs(2.3, 2.0; full_obs=true),
            LinearGsnObs(3.3, 3.0; full_obs=true),
        ],
        t0 = 0.3,
        x0_prior = KnownStartingPt(-2.0),
    ),
]

all_obs = AllObservations()
for recording in recordings
    add_recording!(all_obs, recording)
end</code></pre><p>Observations can be accessed via <code>all_obs.recordings</code>. By default the laws from different recordings are assumed to be independent, but we can tell <code>AllObservations</code> object that they are the same by indicating that the laws share some subsets (possibly all) parameters. This can be done by passing an appropriate dictionary to function <code>add_dependency</code>:</p><pre><code class="language-julia">add_dependency!(
    all_obs,
    Dict(
        :α_shared =&gt; [(rec=1, p_name=:α), (rec=2, p_name=:α)],
        :β_shared =&gt; [(rec=1, p_name=:β), (rec=2, p_name=:β)],
    )
)</code></pre><p>The first (respectively second) entry in the dictionary tells <code>all_obs</code> that there is a parameter, which from now on will be labeled <code>:α_shared</code> (resp. <code>:β_shared</code>), that is present in the law of recording <code>1</code> and the law of recording <code>2</code> and in both of these cases if one calls <code>param_name(P)</code> then the referred to parameter should have a name <code>:α</code> (resp. <code>:β</code>). We can also tell the same thing to <code>AllObservations</code> object differently:</p><pre><code class="language-julia">add_dependency!(
    all_obs,
    Dict(
        :α_shared =&gt; [(rec=1, p_idx=1), (rec=2, p_name=:α)],
        :β_shared =&gt; [(rec=1, p_idx=2, p_name=:β), (rec=2, p_idx=2)],
    )
)</code></pre><p>where instead of specifying the name via <code>p_name</code> we specify the index which this parameter takes when a call to <code>param_name(P)</code> is made. We can also specify both and then the error will be thrown if two access paths are not pointing to the same parameter. The names of the <code>NamedTuple</code>s: <code>(rec=..., p_idx=)</code>, <code>(rec=..., p_name=...)</code> and <code>(rec=..., p_idx=..., p_name=...)</code> above don&#39;t matter (in fact they are later downgraded to regular <code>tuples</code>), only the order of their entries. Now, we can additionally call:</p><pre><code class="language-julia">initialised_all_obs = initialise!(all_obs)</code></pre><p>to perform two useful operations. First, all parameters that are not shared between various laws will be marked (here, there is no such parameter, so this step does not do anything, see example below which illustrates this idea), second, the recordings are split at the times at which full observations are made, as full observations allows for employment of Markov property and treatment of the problem in parallel. As a result, <code>initialised_all_obs</code> now has <code>5</code> recordings, all coming from the same law <code>LawA</code>.</p><h3 id="Recordings-under-multiple-laws-1"><a class="docs-heading-anchor" href="#Recordings-under-multiple-laws-1">Recordings under multiple laws</a><a class="docs-heading-anchor-permalink" href="#Recordings-under-multiple-laws-1" title="Permalink"></a></h3><p>It should be clear that the formalism above allows for definition of recordings coming from multiple diffusion laws. For instance, we can have</p><pre><code class="language-julia">struct LawB γ; β; end
DiffObservScheme.param_names(P::LawB) = [:γ, :β]

extra_recording = (
    P = LawB(30,40),
    obs = [
        LinearGsnObs(1.5, 1.0; Σ=1.0),
        LinearGsnObs(2.5, 2.0; Σ=1.0),
    ],
    t0 = 0.5,
    x0_prior = KnownStartingPt(10.0),
)
push!(recordings, extra_recording)

all_obs = AllObservations()
for recording in recordings
    add_recording!(all_obs, recording)
end</code></pre><p>The dictionary specifying interdependence between diffusion laws can now be defined as follows:</p><pre><code class="language-julia">add_dependency!(
    all_obs,
    Dict(
        :α_shared =&gt; [(rec=1, p_name=:α), (rec=2, p_name=:α)],
        :β_shared =&gt; [(rec=1, p_name=:β), (rec=2, p_name=:β), (rec=3, p_name=:β)],
    )
)</code></pre><p>where, notice presence of additional <code>(rec=3, p_name=:β)</code>. Now, calling</p><pre><code class="language-julia">initialised_all_obs = initialise!(all_obs)</code></pre><p>not only splits the recordings at the time of full observations (resulting in <code>6</code> independent recordings), but also introduces a new named parameter <code>REC3_γ</code> that only the last recording depends on. This comes from the fact that in the original <code>all_obs</code> the third recording came from law <code>LawB</code>, which depended on a parameter <code>γ</code> that was not shared with any other recording and hence did not appear in the interdependency dictionary. Every such &quot;lonely&quot; parameter is introduced by a function <code>initialise!</code> and is given a name by prepending its original name with <code>REC($i)_</code>, with <code>($i)</code> denoting the original index of a recording that the parameter came from.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../start_pt_prior/">« Priors over starting points</a><a class="docs-footer-nextpage" href="../parameterized_obs/">Parameterized observations »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 28 April 2020 10:34">Tuesday 28 April 2020</span>. Using Julia version 1.4.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
