<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Priors over starting points · ObservationSchemes.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ObservationSchemes.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">ObservationSchemes.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../get_started/overview/">Get started</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">User manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../single_observation/">A single observation</a></li><li class="is-active"><a class="tocitem" href>Priors over starting points</a><ul class="internal"><li><a class="tocitem" href="#Known-starting-point-1"><span>Known starting point</span></a></li><li><a class="tocitem" href="#Gaussian-priors-1"><span>Gaussian priors</span></a></li></ul></li><li><a class="tocitem" href="../multiple_observations/">Multiple observations</a></li><li><a class="tocitem" href="../observation_schemes/">Observation schemes</a></li><li><a class="tocitem" href="../utility_functions/">Utility fuctions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">How to...</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../how_to_guides/simple_os/">... ergonomically deal with simple observation schemes?</a></li><li><a class="tocitem" href="../../how_to_guides/custom_priors/">... define custom priors over starting points?</a></li><li><a class="tocitem" href="../../how_to_guides/custom_os/">... define custom observation schemes?</a></li><li><a class="tocitem" href="../../how_to_guides/dataframes/">... work with dataframes?</a></li><li><a class="tocitem" href="../../how_to_guides/csv_files/">... read data directly from a <code>.csv</code> file?</a></li><li><a class="tocitem" href="../../how_to_guides/save_to_files/">... save decorated data to a file?</a></li><li><a class="tocitem" href="../../how_to_guides/other_processes/">... deal with stochastic processes other than diffusions?</a></li><li><a class="tocitem" href="../../how_to_guides/update_params/">... leverage <code>AllObservations</code> to efficiently update parameters?</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/single_path/">Defining an observation scheme for a single trajectory of a FitzHugh–Nagumo model</a></li></ul></li><li><a class="tocitem" href="../../module_index/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User manual</a></li><li class="is-active"><a href>Priors over starting points</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Priors over starting points</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/master/docs/src/manual/start_pt_prior.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Priors-over-starting-points-1"><a class="docs-heading-anchor" href="#Priors-over-starting-points-1">Priors over starting points</a><a class="docs-heading-anchor-permalink" href="#Priors-over-starting-points-1" title="Permalink"></a></h1><hr/><p>On top of decorating each observation with appropriate information, for stochastic processes we need to provide additional information that describes the starting position of the process (as, for instance, no observation may be made at the initial time). This is done through prior distributions.</p><p>All priors over starting points inherit from</p><article class="docstring"><header><a class="docstring-binding" id="ObservationSchemes.StartingPtPrior" href="#ObservationSchemes.StartingPtPrior"><code>ObservationSchemes.StartingPtPrior</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">StartingPtPrior{T}</code></pre><p>Types inheriting from the abstract type <code>StartingPtPrior</code> indicate the prior that is put on the starting point of the observed path of some stochastic process. <code>T</code> denotes the DataType of the starting point.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL1-L7">source</a></section></article><p>They all must implement the following methods</p><article class="docstring"><header><a class="docstring-binding" id="Base.rand-Tuple{ObservationSchemes.StartingPtPrior,Any}" href="#Base.rand-Tuple{ObservationSchemes.StartingPtPrior,Any}"><code>Base.rand</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">Base.rand(G::StartingPtPrior, [z, ρ=0.0])</code></pre><p>Sample a new starting point according to its prior distribution. An implementation with arguments <code>z</code>, <code>ρ</code> implements a preconditioned Crank-Nicolson scheme with memory parameter <code>ρ</code> and a current <strong>non-centered variable</strong> <code>z</code>. <code>z</code> is also referred to as the <strong>driving noise</strong>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL10-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ObservationSchemes.start_pt-Tuple{Any,ObservationSchemes.StartingPtPrior,Any}" href="#ObservationSchemes.start_pt-Tuple{Any,ObservationSchemes.StartingPtPrior,Any}"><code>ObservationSchemes.start_pt</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">start_pt(z, G::StartingPtPrior, P)</code></pre><p>Compute a new starting point from the white noise for a given posterior distribution obtained from combining prior <code>G</code> and the likelihood encoded by the object <code>P</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL22-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ObservationSchemes.start_pt-Tuple{Any,ObservationSchemes.StartingPtPrior}" href="#ObservationSchemes.start_pt-Tuple{Any,ObservationSchemes.StartingPtPrior}"><code>ObservationSchemes.start_pt</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">start_pt(z, G::StartingPtPrior)</code></pre><p>Compute a new starting point from the white noise for a given prior distribution <code>G</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL31-L36">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Distributions.logpdf-Tuple{ObservationSchemes.StartingPtPrior,Any}" href="#Distributions.logpdf-Tuple{ObservationSchemes.StartingPtPrior,Any}"><code>Distributions.logpdf</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">logpdf(G::StartingPtPrior, y)</code></pre><p>log-probability density function evaluated at <code>y</code> of a prior distribution <code>G</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL49-L53">source</a></section></article><p>and should also implement</p><article class="docstring"><header><a class="docstring-binding" id="ObservationSchemes.inv_start_pt-Tuple{Any,ObservationSchemes.StartingPtPrior,Any}" href="#ObservationSchemes.inv_start_pt-Tuple{Any,ObservationSchemes.StartingPtPrior,Any}"><code>ObservationSchemes.inv_start_pt</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">inv_start_pt(y, G::StartingPtPrior, P)</code></pre><p>Compute the driving noise that is needed to obtain starting point <code>y</code> under prior <code>G</code> and the likelihood in <code>P</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL40-L45">source</a></section></article><p>for MCMC setting. In this package we provide implementations for the following types of starting points</p><ul><li>Known, fixed starting points</li><li>Gaussian priors over starting points</li></ul><h2 id="Known-starting-point-1"><a class="docs-heading-anchor" href="#Known-starting-point-1">Known starting point</a><a class="docs-heading-anchor-permalink" href="#Known-starting-point-1" title="Permalink"></a></h2><p>This is the simplest setting in which the starting point is assumed to be known.</p><article class="docstring"><header><a class="docstring-binding" id="ObservationSchemes.KnownStartingPt" href="#ObservationSchemes.KnownStartingPt"><code>ObservationSchemes.KnownStartingPt</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">struct KnownStartingPt{T} &lt;: StartingPtPrior{T}
    y::T
end</code></pre><p>Indicates that the starting point is known and stores its value in <code>y</code></p><pre><code class="language-none">KnownStartingPt(y::T) where T</code></pre><p>Base constructor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL62-L72">source</a></section></article><p>It can be defined with</p><pre><code class="language-julia">x0 = [1.0, 2.0]
x0_prior = KnownStartingPt(x0)</code></pre><p>a call to <code>rand</code> or <code>start_pt</code> will simply return the fixed starting point and <code>logpdf(x0_prior, y)</code> evaluates to <code>0</code> so long as <code>x0 == y</code>.</p><h2 id="Gaussian-priors-1"><a class="docs-heading-anchor" href="#Gaussian-priors-1">Gaussian priors</a><a class="docs-heading-anchor-permalink" href="#Gaussian-priors-1" title="Permalink"></a></h2><p>A Gaussian prior over the starting point.</p><article class="docstring"><header><a class="docstring-binding" id="ObservationSchemes.GsnStartingPt" href="#ObservationSchemes.GsnStartingPt"><code>ObservationSchemes.GsnStartingPt</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">struct GsnStartingPt{T,S,TM} &lt;: StartingPtPrior{T} where {S}
    μ::T
    Σ::S
    Λ::S
    μ₀::T
    Σ₀::UniformScaling
end</code></pre><p>Indicates that the starting point is equipped with a Gaussian prior with mean <code>μ</code> and covariance matrix <code>Σ</code> (and pre-computed precision <code>Λ</code>:=<code>Σ</code>⁻¹). Sampling is always done via non-centred parametrization, by sampling white noise <code>z</code> according to Gaussian with zero mean and identity covariance: <code>μ₀</code> and <code>Σ₀</code>, and then transforming <code>z</code> to a variable with mean and covariance <code>μ</code> and <code>Σ</code>.</p><pre><code class="language-none">GsnStartingPt(μ::T, Σ::S)</code></pre><p>Base constructor. It initialises the mean <code>μ</code> and covariance <code>Σ</code> parameters and <code>Λ</code> is set according to <code>Λ</code>:=<code>Σ</code>⁻¹.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL78-L97">source</a></section></article><p>Can be defined with</p><pre><code class="language-julia">μ, Σ = [1.0, 2.0], [1.0 0.0; 0.0 1.0]
x0_prior = GsnStartingPt(μ, Σ)</code></pre><p>to set the mean and covariance to <code>μ</code> and <code>Σ</code> respectively. The underlying idea behind Gaussian starting point priors is that of non-centred parametrisation, so that a possibility of local updates is granted. More precisely any sampling is done with <code>z∼N(0,Id)</code> variables, which are then transformed to <code>N(μ,Σ)</code> via linear transformations. In particular, sampling with <code>rand</code> can be done with local perturbations via Crank-Nicolson scheme.</p><article class="docstring"><header><a class="docstring-binding" id="Base.rand" href="#Base.rand"><code>Base.rand</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">Base.rand(G::StartingPtPrior, [z, ρ=0.0])</code></pre><p>Sample a new starting point according to its prior distribution. An implementation with arguments <code>z</code>, <code>ρ</code> implements a preconditioned Crank-Nicolson scheme with memory parameter <code>ρ</code> and a current <strong>non-centered variable</strong> <code>z</code>. <code>z</code> is also referred to as the <strong>driving noise</strong>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL10-L17">source</a></section><section><div><pre><code class="language-julia">rand([rng::Random.AbstractRNG], G::GsnStartingPt, z, ρ=0.0)</code></pre><p>Sample new white noise using Crank-Nicolson scheme with memory parameter <code>ρ</code> and a previous value of the white noise stored inside object <code>G</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL136-L141">source</a></section><section><div><pre><code class="language-julia">rand([rng::Random.AbstractRNG], G::GsnStartingPt)</code></pre><p>Sample new starting point according to its prior distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL150-L154">source</a></section><section><div><pre><code class="language-julia">rand([rng::Random.AbstractRNG], G::KnownStartingPt, args...)</code></pre><p>Starting point is known. Nothing can be sampled. Returning known starting point.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL161-L165">source</a></section><section><div><pre><code class="language-julia">Base.rand([rng::Random.AbstractRNG], o::LinearGsnObs, X)</code></pre><p>Sample an observation according to</p><div>\[V ∼ L X + ξ,\quad \mbox{where } ξ∼N(μ,Σ),\]</div><p>with <span>$L$</span>, <span>$μ$</span> and <span>$Σ$</span> defined in <code>o</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/observations_linear_gaussian.jl#LL200-L208">source</a></section></article><p><code>inv_start_pt</code> returns the non-centrally parametrised noise <code>z</code> that produces a given starting point <code>x0</code>:</p><article class="docstring"><header><a class="docstring-binding" id="ObservationSchemes.inv_start_pt" href="#ObservationSchemes.inv_start_pt"><code>ObservationSchemes.inv_start_pt</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">inv_start_pt(y, G::StartingPtPrior, P)</code></pre><p>Compute the driving noise that is needed to obtain starting point <code>y</code> under prior <code>G</code> and the likelihood in <code>P</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL40-L45">source</a></section><section><div><pre><code class="language-julia">inv_start_pt(y, G::GsnStartingPt, P)</code></pre><p>Compute the driving noise that is needed to obtain starting point <code>y</code> under prior <code>G</code> and the likelihood in <code>P</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL217-L222">source</a></section><section><div><pre><code class="language-julia">inv_start_pt(y, G::KnownStartingPt, P)</code></pre><p>Starting point known, no need for dealing with white noise, use convention of returning <code>y</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL235-L240">source</a></section></article><p>and <code>start_pt</code> is the reverse operation</p><article class="docstring"><header><a class="docstring-binding" id="ObservationSchemes.start_pt" href="#ObservationSchemes.start_pt"><code>ObservationSchemes.start_pt</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">start_pt(z, G::StartingPtPrior, P)</code></pre><p>Compute a new starting point from the white noise for a given posterior distribution obtained from combining prior <code>G</code> and the likelihood encoded by the object <code>P</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL22-L28">source</a></section><section><div><pre><code class="language-julia">start_pt(z, G::StartingPtPrior)</code></pre><p>Compute a new starting point from the white noise for a given prior distribution <code>G</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL31-L36">source</a></section><section><div><pre><code class="language-julia">start_pt(z, G::GsnStartingPt, P)</code></pre><p>Compute a new starting point from the white noise for a given posterior distribution obtained from combining prior <code>G</code> and the likelihood encoded by the object <code>P</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL176-L182">source</a></section><section><div><pre><code class="language-julia">start_pt(z, G::GsnStartingPt)</code></pre><p>Compute a new starting point from the white noise for a given prior distribution <code>G</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL190-L195">source</a></section><section><div><pre><code class="language-julia">start_pt(z, G::KnownStartingPt, P)</code></pre><p>Return starting point</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL198-L202">source</a></section><section><div><pre><code class="language-julia">start_pt(G::KnownStartingPt, P)</code></pre><p>Return starting point</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDiffusionBayes/ObservationSchemes.jl/blob/8a9cd547b2c5206480582aef449fb20b7478f5ff/src/starting_point_priors.jl#LL206-L210">source</a></section></article><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>To see how to define your own priors over starting points see a How-to-guide on <a href="../../how_to_guides/custom_priors/#how_to_custom_prior-1">Defining custom priors over starting points</a></p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../single_observation/">« A single observation</a><a class="docs-footer-nextpage" href="../multiple_observations/">Multiple observations »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 16 June 2020 00:23">Tuesday 16 June 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
